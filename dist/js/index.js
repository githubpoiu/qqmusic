var root=window.player,render=root.render,rotate=root.rotate,proController=root.proController,audioManager=null,audio=null,songList=[],index=0,len=0,timer=-1;function getData(o){$.ajax({url:o,method:"GET",success:function(o){index=0,len=(songList=o).length,render(songList[0],index,songList),audioManager=new root.AudioManager(songList[index].audio),root.audio=audio=audioManager.audio,proController.init(),bindEvent()},error:function(){console.log("error")}})}function bindEvent(){var o=$(".pro-bottom").offset(),e=o.left,t=o.width;function i(o){var n=((o.clientX||o.changedTouches[0].clientX)-e)/t;return n<0&&(n=0),1<n&&(n=1),n}function r(){clearInterval(timer)}function a(o){var n;o&&(n=o.deg),audio.paused?(r(),$(".play").removeClass("playing"),rotate.stop()):(r(),timer=setInterval(function(){proController.updateByAudio(),audio.ended&&$(".next").trigger("click")},1e3/60),$(".play").addClass("playing"),null!=n?rotate.run(n):rotate.run())}function n(){render(songList[index],index),audioManager.loadAudio(songList[index].audio),proController.updateBuffered(),audio.play(),a({deg:0})}$(".pro-box").on("click",function(o,n){var e=i(o=n||o);audioManager.playByPer(e),audio.ended?$(".next").trigger("click"):audioManager.play(),a()}),$(".spot").on("touchstart",function(o){return audioManager.pause(),a(),!1}).on("touchmove",function(o){var n=i(o);proController.updateByPer(n)}).on("touchend",function(o){$(".pro-box").trigger("click",o)}),$(".play").on("click",function(){audioManager.togglePlay(),a()}),$(".prev").on("click",function(){index=(index-1+len)%len,n()}),$(".next").on("click",function(){index=(index+1)%len,n()}),$(".btn.list").on("click",function(){$(".song-list").addClass("show")}),$(".close").add(".song-list").on("click",function(){$(".song-list").removeClass("show")}),$(".list-box").on("click",function(){return!1}),$(".song-item").on("click",function(o){$(".song-list").addClass("show"),index=$(this).index(),n()})}getData("https://githubpoiu.github.io/qqmusic/source/data.json"),window.onload=function(){$(".loading").hide()};